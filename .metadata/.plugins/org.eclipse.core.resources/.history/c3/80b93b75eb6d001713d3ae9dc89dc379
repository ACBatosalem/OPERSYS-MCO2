package views;

import java.util.ArrayList;

import javafx.animation.AnimationTimer;
import javafx.scene.image.ImageView;
import javafx.scene.layout.Pane;

public class Track {
	public Pane layout;
	public ArrayList<Train> trains;
	public ArrayList<AnimationTimer> anims;
	
	private int num = 10;
	private int num2 = 10;
	private boolean right = false;
	private boolean up = false;
	private boolean left = false;
	private boolean reverse = false;
	private boolean down = false;
	private boolean last = false;
	
	private final static int hBounds = 450, wBounds = 450;
	
	public Track(){
		layout = new Pane();
		trains = new ArrayList<>();
		anims = new ArrayList<>();
	}
	
	public boolean createTrain(){
		Train t = new Train();
		return trains.add(t);
	}
	
	public boolean createPath(ImageView train){
		AnimationTimer timer = new AnimationTimer(){
			@Override
            public void handle(long now) {
            	if(num < hBounds && !right && !up && !reverse){
            		num += 5;
                	train.setTranslateY(train.getLayoutY() + num);
            	}
            	else if(num >= hBounds && !right && !up && !reverse){
            		right = true;
            		train.setRotate(0);
            	}
            	
            	if(num2 < wBounds && right && !up && !left && !reverse && !last){
            		num2 += 5;
            		train.setTranslateX(train.getLayoutX() + num2);
            	}
            	else if(num2 >= wBounds && !up && !reverse && !last){
            		if(right){
            			right = false;
            			up = true;
                		train.setRotate(-90);
            		}
            	}
            	
            	if(num > 20 && up && !right && !reverse){
            		num = num - 5;
            		train.setTranslateY(train.getLayoutY() + num);
            	}
            	else if(num <= 20 && up && !right && !left && !reverse){
            		right = true;
            		left = true;
            		train.setRotate(180);
            	}
            	
            	if(num2 > 50 && left && !reverse && !last){
            		num2 -= 5;
            		train.setTranslateX(train.getLayoutX() + num2);
            	}
            	else if(num2 <= 50 && left && !reverse && !last){
            		train.setTranslateY(50);
            		right = false;
            		left = false;
            		reverse = true;
            		train.setRotate(0);
            	}
            	
            	if(num2 < wBounds - 50 && reverse && !left && !last){
            		num2 += 5;
            		train.setTranslateX(train.getLayoutX() + num2);
            	}
            	else if(num2 >= wBounds - 50 && reverse && !left && !last){
            		down = true;
            		train.setRotate(90);
            	}
            	
            	if(num < hBounds - 50 && reverse && down && !left && !last){
            		num += 5;
            		train.setTranslateY(train.getLayoutY() + num);
            	}
            	else if(num >= wBounds - 50 && reverse && down && !left && !last){
            		train.setRotate(180);
            		left = true;
            		down = false;
            	}
            	
            	if(num2 > 50 && reverse && left && !last){
            		num2 -= 5;
            		train.setTranslateX(train.getLayoutX() + num2);
            	}
            	else if(num2 <= 50 && reverse && left && !last){
            		left = false;
            		train.setRotate(-90);
            		last = true;
            	}
            	
            	if(num > 50 && reverse && last){
            		num -= 5;
            		train.setTranslateY(train.getLayoutY() + num);
            	}
            	else if(num >= 50 && reverse && last){
            		train.setRotate(90);
            		last = false;
            		train.setTranslateX(0);
            		right = false;
            		up = false;
            		left = false;
            		reverse = false;
            		down = false;
            	}
			}
		};
		
		return anims.add(timer);
	}
	
	public setUpLayout(){
		
	}
	
}
